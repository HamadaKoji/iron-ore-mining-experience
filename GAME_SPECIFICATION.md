# 初めての鉄鉱石採掘体験 - ゲーム仕様書

## 概要
Factorio風の簡易工場シミュレーションゲーム。プレイヤーは採掘機、ベルトコンベア、チェストを使って複数の資源（鉄鉱石、銅鉱石、石炭）の採掘・運搬・回収システムを構築する。

## 基本仕様

### ゲーム画面
- **マップサイズ**: 25x18のグリッド
- **セルサイズ**: 32x32ピクセル
- **キャンバスサイズ**: 800x600ピクセル
- **技術構成**: HTML5 Canvas + JavaScript ES6モジュール（外部ライブラリなし）
- **レイアウト**: サイドパネル型（ゲーム画面 + 統計パネル）

### 地形システム
- **草地**: 緑色の背景 + 🌱アイコン、建物設置可能（88%出現率）
- **鉄鉱石エリア**: 茶色の背景 + 🪨アイコン、採掘機設置可能（5%出現率）
- **銅鉱石エリア**: オレンジ色の背景 + 🟫アイコン、採掘機設置可能（4%出現率）
- **石炭エリア**: 黒色の背景 + ⚫アイコン、採掘機設置可能（3%出現率）
- **地形生成**: ランダム生成、バランス調整済み

## 資源システム

### 1. 鉄鉱石 (🔩)
- **採掘場所**: 鉄鉱石エリア（茶色）
- **アイテム表示**: 🔩 + オレンジ境界線
- **用途**: 製錬炉で鉄板に加工

### 2. 銅鉱石 (🟠)
- **採掘場所**: 銅鉱石エリア（オレンジ）
- **アイテム表示**: 🟠 + 茶色境界線
- **用途**: 製錬炉で銅板に加工

### 3. 石炭 (⚫)
- **採掘場所**: 石炭エリア（黒）
- **アイテム表示**: ⚫ + 濃いグレー境界線
- **用途**: 製錬炉の燃料

### 4. 鉄板 (🟦)
- **生産方法**: 製錬炉で鉄鉱石+石炭から生成
- **アイテム表示**: 🟦 + 青色境界線
- **価値**: 鉱石の3倍ポイント

### 5. 銅板 (🟧)
- **生産方法**: 製錬炉で銅鉱石+石炭から生成
- **アイテム表示**: 🟧 + オレンジ色境界線
- **価値**: 鉱石の3倍ポイント

## 建物システム

### 1. 採掘機 (⛏️)
- **設置条件**: 任意の資源エリア（鉄鉱石、銅鉱石、石炭）
- **機能**: 設置された資源エリアに応じた資源を自動採掘
- **採掘速度**: 2秒に1個（全資源共通）
- **出力**: 設置場所に応じた資源アイテム
- **表示**: 灰色背景 + ⛏️絵文字
- **資源判定**: 設置時に地形タイプを記録し、対応する資源を生成
- **アイテム出力**: 隣接するベルトの方向を確認し、適切な方向のベルトに出力
  - 右側のベルト: 右向き(➡️)で受け取り
  - 下側のベルト: 下向き(⬇️)で受け取り
  - 左側のベルト: 左向き(⬅️)で受け取り
  - 上側のベルト: 上向き(⬆️)で受け取り

### 2. ベルトコンベア
- **設置条件**: 任意の場所
- **機能**: アイテムを指定方向に運搬（全資源タイプ対応）
- **運搬方向**: 
  - 右 (➡️)
  - 下 (⬇️)
  - 左 (⬅️)
  - 上 (⬆️)
- **運搬速度**: 0.5秒に1マス移動
- **表示**: 青色背景 + 方向別絵文字
- **対応資源**: 全資源タイプ（鉄、銅、石炭、鉄板、銅板）を運搬可能
- **方向選択**: ツールバーの方向ボタンで設置前に選択

### 3. チェスト (📦)
- **設置条件**: 任意の場所
- **機能**: 全資源タイプのアイテムを自動回収
- **効果**: 各資源カウンターを個別に増加
- **表示**: 金色背景 + 📦絵文字
- **回収対象**: 鉄鉱石、銅鉱石、石炭、鉄板、銅板すべて

### 4. 製錬炉 (🔥)
- **設置条件**: 草地のみ（資源エリアには設置不可）
- **機能**: 鉱石を金属板に加工
- **入力**:
  - 鉄鉱石 + 石炭 → 鉄板
  - 銅鉱石 + 石炭 → 銅板
- **製錬時間**: 4秒/個
- **表示**: 赤茶色背景 + 🔥絵文字
- **状態表示**:
  - 製錬中: 進行バー表示
  - 燃料切れ: グレーアウト表示
- **バッファ**: 鉱石1個、石炭1個、完成品1個まで保持
- **アイテム出力**: 隣接するベルトの方向を確認し、適切な方向のベルトに出力
  - 右側のベルト: 右向き(➡️)で出力
  - 下側のベルト: 下向き(⬇️)で出力
  - 左側のベルト: 左向き(⬅️)で出力
  - 上側のベルト: 上向き(⬆️)で出力

## UI/UXシステム

### メインレイアウト
- **ヘッダー**: タイトル + ツールバー（横並び）
- **ゲーム画面**: 800x600px、左側メインエリア
- **サイドパネル**: 350px幅、右側統計・情報エリア

### 統計パネル
- **生産統計**: 9つの統計カード
  - 鉄鉱石: 🔩 + 生産量・レート
  - 銅鉱石: 🟠 + 生産量・レート  
  - 石炭: ⚫ + 生産量・レート
  - 鉄板: 🟦 + 生産量・レート
  - 銅板: 🟧 + 生産量・レート
  - 採掘機: ⛏️ + 設置数・稼働率
  - ベルト: ➡️ + 設置数・使用率
  - チェスト: 📦 + 設置数・容量率
  - 製錬炉: 🔥 + 設置数・稼働率

### 生産グラフ
- **リアルタイム更新**: 1秒間隔
- **履歴保持**: 最大60データポイント
- **表示内容**: 各資源の生産レート推移

### 操作ガイド
- **段階的ヒント**: 進行状況に応じた案内
- **初回**: 任意の資源エリアに採掘機設置
- **2段階**: ベルトで運搬ライン構築
- **3段階**: チェストでアイテム回収
- **4段階**: 製錬炉で金属板を生産
  - 石炭エリアに採掘機を設置
  - 製錬炉を草地に設置
  - 鉱石と石炭を製錬炉へ運搬
  - 金属板を回収ラインへ接続

## ゲームメカニクス

### アイテムフロー
1. **採掘**: 採掘機が資源エリアから対応する資源を生成
2. **運搬**: ベルトが右方向にアイテムを移動
3. **加工**: 製錬炉が鉱石と石炭から金属板を生成
4. **回収**: チェストがアイテムを回収し、統計に反映

### 製錬システム
- **入力**: ベルトから鉱石と石炭を自動受け取り
- **処理**: 両方の材料が揃ったら製錬開始
- **出力**: 完成した金属板を右側へ自動排出
- **効率**: 石炭管理と製錬ライン設計が重要

### 統計システム
- **個別追跡**: 各資源の生産量を独立して管理
- **生産レート**: 分単位での生産効率計算
- **リアルタイム更新**: 1秒間隔での統計更新

### 建物配置ルール
- **採掘機**: 資源エリアのみ設置可能
- **製錬炉**: 草地のみ設置可能
- **ベルト・チェスト**: 任意の場所に設置可能
- **重複禁止**: 同じマスに複数の建物は設置不可

## 技術仕様

### アーキテクチャ
- **モジュラー設計**: ES6モジュールによる機能分割
- **主要モジュール**:
  - `config.js`: ゲーム設定・定数
  - `terrain.js`: 地形生成・管理
  - `buildings.js`: 建物配置・管理
  - `items.js`: アイテム移動・回収
  - `renderer.js`: 描画処理
  - `game.js`: メインゲームループ

### パフォーマンス
- **フレームレート**: 60fps目標
- **更新頻度**: 
  - 採掘: 2秒間隔
  - アイテム移動: 0.5秒間隔
  - 統計更新: 1秒間隔

## バランス設定

### 地形生成確率
- **草地**: 63%
- **鉄鉱石**: 15%
- **銅鉱石**: 12%
- **石炭**: 10%

### 生産効率
- **採掘速度**: 全資源2秒/個（統一）
- **運搬速度**: 0.5秒/マス
- **統計更新**: 1秒間隔

この仕様書は実装されている機能と完全に同期しており、ゲームの現在の状態を正確に反映しています。

---

**最終更新**: 2025年6月30日  
**バージョン**: 2.1（4方向ベルトシステム対応）  
**対象**: 初心者向け工場シミュレーション体験
